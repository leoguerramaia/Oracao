<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
  import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js";

  const firebaseConfig = { /* ...mesmo config... */ };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  document.getElementById("formLogin").addEventListener("submit", async (e)=>{
    e.preventDefault();

    const email = document.getElementById("email").value.trim().toLowerCase();
    const senha = document.getElementById("senha").value;

    const q = query(collection(db, "cadastrosUsuarios"), where("email","==",email), where("senha","==",senha));
    const snap = await getDocs(q);

    if(snap.empty){
      alert("❌ Usuário ou senha incorretos.");
      return;
    }

    let usuario = null;
    snap.forEach(doc => usuario = doc.data());

    localStorage.setItem("usuarioLogado", JSON.stringify(usuario));
    alert("✅ Login realizado com sucesso!");
    window.location.href = "menulogado.html";
  });
</script>
