<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Administra√ß√£o - Pedidos de Ora√ß√£o</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family:Arial,sans-serif;background:#f4f6f8;margin:0}
    header{
      background:#2c3e50;color:#fff;padding:20px 16px;
      display:flex;justify-content:space-between;align-items:center;
      box-shadow:0 2px 10px rgba(0,0,0,.15)
    }
    header h1{margin:0;font-size:22px}
    .user-info{font-size:14px;text-align:right}
    .user-info span{display:block}
    .logout{
      background:#e74c3c;color:#fff;border:none;padding:6px 10px;
      border-radius:6px;cursor:pointer;font-size:12px;margin-top:4px
    }
    .logout:hover{background:#c0392b}

    .container{
      max-width:800px;margin:40px auto;background:#fff;padding:24px;
      border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,.1);text-align:center
    }
    h2{margin:0 0 20px 0}
    .actions{display:flex;flex-direction:column;gap:12px;margin-top:20px}
    .btn{
      padding:14px;border:none;border-radius:10px;font-size:16px;font-weight:bold;
      cursor:pointer;transition:background .3s;width:100%
    }
    .btn-secondary{background:#3498db;color:#fff}
    .btn-secondary:hover{background:#2980b9}
    .btn-accent{background:#8e44ad;color:#fff}
    .btn-accent:hover{background:#732d91}
    .btn-home{background:#fff;color:#2c3e50;border:1px solid #ccc}
    .btn-home:hover{background:#f7f9fb}
  </style>
</head>
<body>
  <header>
    <h1>‚öôÔ∏è Administra√ß√£o</h1>
    <div class="user-info" id="userInfo"></div>
  </header>

  <div class="container">
    <h2>Bem-vindo √† √°rea administrativa</h2>
    <p>Escolha uma das op√ß√µes abaixo:</p>

    <div class="actions">
      <button class="btn btn-secondary" onclick="location.href='cadastroadmin.html'">üë• Gerenciar Cadastros</button>
      <button class="btn btn-accent" onclick="location.href='usuariologado.html'">üôè Pedido de Ora√ß√£o</button>
      <button class="btn btn-home" onclick="location.href='index.html'">üè† P√°gina Inicial</button>
    </div>
  </div>

  <script>
    // Helper: determina se um usu√°rio √© admin
    function isAdmin(user, cadastros) {
      if (!user) return false;

      const email = (user.email || "").toLowerCase();
      const adminsFixos = ["leoguerramaia@gmail.com", "admin@admin.com.br", "admin"];

      // Admin por e-mail fixo
      if (adminsFixos.includes(email)) return true;

      // Procura cadastro completo para checar flags
      const registro = (cadastros || []).find(u => (u.email || "").toLowerCase() === email);
      if (!registro) return false;

      return registro.fixo === true || registro.isAdmin === true;
    }

    document.addEventListener("DOMContentLoaded", () => {
      // Verifica login
      const userLogado = JSON.parse(localStorage.getItem("usuarioLogado"));
      if (!userLogado) {
        alert("‚ö†Ô∏è Voc√™ precisa estar logado para acessar esta p√°gina.");
        window.location.replace("login.html");
        return;
      }

      // Carrega cadastros para verificar privil√©gios
      const cadastros = JSON.parse(localStorage.getItem("cadastrosUsuarios")) || [];

      // Se n√£o for admin, redireciona
      if (!isAdmin(userLogado, cadastros)) {
        alert("‚õî Acesso restrito a administradores.");
        window.location.replace("usuariologado.html");
        return;
      }

      // Exibe info do usu√°rio
      const primeiroNome = (userLogado.nome || "Usu√°rio").split(" ")[0];
      const info = document.getElementById("userInfo");
      info.innerHTML = `
        <span><strong>${primeiroNome}</strong></span>
        <span>${userLogado.email || ""}</span>
        <button class="logout" id="logoutBtn">Sair</button>
      `;

      // Logout
      document.getElementById("logoutBtn").addEventListener("click", () => {
        localStorage.removeItem("usuarioLogado");
        window.location.href = "login.html";
      });
    });
  </script>
</body>
</html>
